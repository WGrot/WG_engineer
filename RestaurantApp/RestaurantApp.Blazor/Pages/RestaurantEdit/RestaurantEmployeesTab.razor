@using RestaurantApp.Blazor.Models.Response
@using RestaurantApp.Shared.Models
@inject HttpClient Http
@inject NavigationManager Navigation
<h3>RestaurantEmployeesTab</h3>
@if (isLoading)
{
    <p>Loading reservations...</p>
}
else if (error != null)
{
    <p>Error: @error</p>
}
else if (employees == null || !employees.Any())
{
    <p>You don't have any reservations yet.</p>
}
else
{
    <ul>
        @foreach (var employee in employees)
        {
            <li>
                <div>
                    <strong>@employee.LastName @employee.FirstName</strong><br/>
                    Email : @employee.Email<br/>
                    PhoneNumber : @employee.PhoneNumber<br/>
                </div>
                <hr/>
            </li>
        }
    </ul>
}

@code {
    [Parameter] public int Id { get; set; }
    [Parameter] public Restaurant? restaurant { get; set; }
    private bool isLoading = true;
    private string? error;
    private List<ResponseRestaurantEmployeeDto> employees = new List<ResponseRestaurantEmployeeDto>();

    protected override async Task OnInitializedAsync()
    {
        await LoadEmployees();
    }

    private async Task LoadEmployees()
    {
        try
        {
            employees = await Http.GetFromJsonAsync<List<ResponseRestaurantEmployeeDto>>($"api/Employees/restaurant/{Id}");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading restaurant: {ex.Message}");
        }
        finally
        {
            isLoading = false;
        }
    }

}